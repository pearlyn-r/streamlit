def extract_mapping_from_xlwings_sheet(wb, sheet_name='mapping'):
    try:
        ws = wb.sheets[sheet_name]
        mapping = {}

        data = ws.range("A2").expand('down').value
        for row in data:
            key = str(row[0]).strip() if row[0] else None
            comment = str(row[1]).strip() if len(row) > 1 and row[1] else ""
            if key:
                mapping[key] = comment

        print(f"✅ Loaded {len(mapping)} mapping entries from '{sheet_name}'.")
        return mapping
    except Exception as e:
        print(f"❌ Failed to extract mapping from xlwings: {e}")
        return {}
def extract_mapping_from_xlwings_sheet(wb, sheet_name='mapping'):
    try:
        ws = wb.sheets[sheet_name]
        mapping = {}

        data = ws.range("A2").expand('down').value
        for row in data:
            key = str(row[0]).strip() if row[0] else None
            comment = str(row[1]).strip() if len(row) > 1 and row[1] else ""
            if key:
                mapping[key] = comment

        print(f"✅ Loaded {len(mapping)} mapping entries from '{sheet_name}'.")
        return mapping
    except Exception as e:
        print(f"❌ Failed to extract mapping from xlwings: {e}")
        return {}
