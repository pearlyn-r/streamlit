if mapping_column_idx < len(selected.columns):
                mapping_column_name = selected.columns[mapping_column_idx]
                for i in range(len(selected)):
                    key = str(selected.iat[i, mapping_column_idx]).strip()
                    selected.at[i, 'comment'] = current_mapping.get(key, 'Under investigation')
                print(f"Mapping applied using column index {mapping_column_idx} for '{data_type_prefix}' data.")
            else:
                print(f"Error: Column index {mapping_column_idx} out of bounds for '{data_type_prefix}' data.")
                selected['comment'] = f"Mapping column index {mapping_column_idx} out of bounds"
        else:
            print(f"Warning: No mapping dictionary provided for '{data_type_prefix}' data. Comments not applied.")
