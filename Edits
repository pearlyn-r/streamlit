def extract_data(df):
    try:
        selected = df.iloc[:, [0, 1, 4, 6, 8]].copy()
        selected.columns = ['A', 'B', 'E', 'G', 'N']

        # Force numeric conversion for numeric columns
        for col in ['E', 'G', 'N']:
            selected[col] = pd.to_numeric(selected[col], errors='coerce')

        selected.dropna(how='all', inplace=True)
        return selected
    except Exception as e:
        print(f"Error extracting data: {e}")
        return None

for row_idx, row in enumerate(dataframe_to_rows(extracted_data, index=False, header=False), 2):
    for col_idx, value in enumerate(row, 1):
        cell = sheet1.cell(row=row_idx, column=col_idx)
        if isinstance(value, (int, float)):
            cell.value = value
            cell.number_format = '0.00'  # Optional formatting
        else:
            cell.value = value
